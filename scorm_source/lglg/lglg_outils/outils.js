function clavier(){(affichClavier=!affichClavier)?($("#outil-clavier").addClass("choisi"),champSaisie.parentElement&&afficherClavier(champSaisie.parentElement.id.split("_")[1])):(effacerClavier(),$("#outil-clavier").removeClass("choisi"))}
function afficherClavier(a){effacerClavier();if(tblExo.clavier){for(var e in tblExo.clavier){var d=document.createElement("button");d.innerHTML=tblExo.clavier[e];document.querySelector("#ctnClavier_"+a).appendChild(d)}$("#ctnClavier_"+a+" button").click(function(a){champSaisie.type="textarea";var b=champSaisie.selectionStart+1;champSaisie.value=champSaisie.value.substring(0,champSaisie.selectionStart)+a.target.innerHTML+champSaisie.value.substring(champSaisie.selectionEnd,champSaisie.length);champSaisie.focus();
champSaisie.setSelectionRange(b,b);a=champSaisie.parentElement.id.split("_")[1];tblReponses[pCourante].reps[a]=champSaisie.value;verifAccesCorr()})}}function effacerClavier(){for(var a=document.getElementsByClassName("ctnClavierClass"),e=0;e<a.length;e++){var d=document.getElementById("ctnClavier_"+e);if(d)for(;d.firstChild;)d.removeChild(d.firstChild)}}
function impression(){var a=new Date,e=RegExp("<.[^>]*>","gi"),d=RegExp("&nbsp;","gi"),b=tblExo.titre+" -- "+a.toLocaleString();scorm&&(b=tblExo.titre+" -- "+SCOGetValue("cmi.core.student_name")+" -- "+a.toLocaleString());a={header:{text:b,style:"titre",margin:[15,15,15,0]},content:[{}],styles:{titre:{bold:!0},maQuestion:{italics:!0,fontSize:9},maReponse:{margin:[10,0,10,0]}}};for(b=0;b<tblReponses.length;b++)for(var f=0;f<tblReponses[b].reps.length;f++)if(a.content.push({text:" ",marginBottom:7}),
"qtrous"===tblExo.pages[b].questions[f].type)for(var c=tblExo.pages[b].questions[f].txtQuestion,c=c.replace(e," "),c=c.replace(d," "),c=c.split(":SHORTANSWER:"),g=0;g<c.length;g++)a.content.push({text:c[g],style:"maQuestion"}),a.content.push({text:"-"+tblReponses[b].reps[f][g]});else c=tblExo.pages[b].questions[f].txtQuestion,c=c.replace(e,""),c=c.replace(d," "),g=tblReponses[b].reps[f],0<g.length&&(a.content.push({text:c,style:"maQuestion"}),a.content.push({text:g,style:"maReponse"}));pdfMake.createPdf(a).open()}
function doc(){var a="module/fiche.pdf";tblExo.stUrl&&!scorm&&(a=tblExo.stUrl.replace(".vtt",".pdf"));window.open(a)};
